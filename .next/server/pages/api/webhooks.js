/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(function() {
var exports = {};
exports.id = "pages/api/webhooks";
exports.ids = ["pages/api/webhooks"];
exports.modules = {

/***/ "./src/pages/api/_lib/manageSubscription.ts":
/*!**************************************************!*\
  !*** ./src/pages/api/_lib/manageSubscription.ts ***!
  \**************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"saveSubscription\": function() { return /* binding */ saveSubscription; }\n/* harmony export */ });\n/* harmony import */ var faunadb__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! faunadb */ \"faunadb\");\n/* harmony import */ var faunadb__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(faunadb__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _services_fauna__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../services/fauna */ \"./src/services/fauna.ts\");\n/* harmony import */ var _services_stripe__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../services/stripe */ \"./src/services/stripe.ts\");\n\n\n\nasync function saveSubscription(subscriptionId, customerId, createAction = false) {\n  const userRef = await _services_fauna__WEBPACK_IMPORTED_MODULE_1__.fauna.query(faunadb__WEBPACK_IMPORTED_MODULE_0__.query.Select(\"ref\", faunadb__WEBPACK_IMPORTED_MODULE_0__.query.Get(faunadb__WEBPACK_IMPORTED_MODULE_0__.query.Match(faunadb__WEBPACK_IMPORTED_MODULE_0__.query.Index('user_by_stripe_customer_id'), customerId))));\n  const subscription = await _services_stripe__WEBPACK_IMPORTED_MODULE_2__.stripe.subscriptions.retrieve(subscriptionId);\n  const subscriptionData = {\n    id: subscription.id,\n    userId: userRef,\n    status: subscription.status,\n    price_id: subscription.items.data[0].price.id\n  };\n  console.log(createAction);\n\n  if (createAction) {\n    await _services_fauna__WEBPACK_IMPORTED_MODULE_1__.fauna.query(faunadb__WEBPACK_IMPORTED_MODULE_0__.query.Create(faunadb__WEBPACK_IMPORTED_MODULE_0__.query.Collection('subscriptions'), {\n      data: subscriptionData\n    }));\n  } else {\n    await _services_fauna__WEBPACK_IMPORTED_MODULE_1__.fauna.query(faunadb__WEBPACK_IMPORTED_MODULE_0__.query.Replace(faunadb__WEBPACK_IMPORTED_MODULE_0__.query.Select(\"ref\", faunadb__WEBPACK_IMPORTED_MODULE_0__.query.Get(faunadb__WEBPACK_IMPORTED_MODULE_0__.query.Match(faunadb__WEBPACK_IMPORTED_MODULE_0__.query.Index('subscription_by_id'), subscriptionId))), {\n      data: subscriptionData\n    }));\n  }\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9pZ25ld3MvLi9zcmMvcGFnZXMvYXBpL19saWIvbWFuYWdlU3Vic2NyaXB0aW9uLnRzP2YzMDgiXSwibmFtZXMiOlsic2F2ZVN1YnNjcmlwdGlvbiIsInN1YnNjcmlwdGlvbklkIiwiY3VzdG9tZXJJZCIsImNyZWF0ZUFjdGlvbiIsInVzZXJSZWYiLCJmYXVuYSIsInEiLCJzdWJzY3JpcHRpb24iLCJzdHJpcGUiLCJzdWJzY3JpcHRpb25EYXRhIiwiaWQiLCJ1c2VySWQiLCJzdGF0dXMiLCJwcmljZV9pZCIsIml0ZW1zIiwiZGF0YSIsInByaWNlIiwiY29uc29sZSIsImxvZyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQTtBQUVBO0FBQ0E7QUFFTyxlQUFlQSxnQkFBZixDQUNMQyxjQURLLEVBRUxDLFVBRkssRUFHTEMsWUFBWSxHQUFHLEtBSFYsRUFJTDtBQUNBLFFBQU1DLE9BQU8sR0FBRyxNQUFNQyx3REFBQSxDQUNwQkMsaURBQUEsQ0FDRSxLQURGLEVBRUVBLDhDQUFBLENBQ0VBLGdEQUFBLENBQ0VBLGdEQUFBLENBQVEsNEJBQVIsQ0FERixFQUVFSixVQUZGLENBREYsQ0FGRixDQURvQixDQUF0QjtBQVlBLFFBQU1LLFlBQVksR0FBRyxNQUFNQywyRUFBQSxDQUE4QlAsY0FBOUIsQ0FBM0I7QUFFQSxRQUFNUSxnQkFBZ0IsR0FBRztBQUN2QkMsTUFBRSxFQUFFSCxZQUFZLENBQUNHLEVBRE07QUFFdkJDLFVBQU0sRUFBRVAsT0FGZTtBQUd2QlEsVUFBTSxFQUFFTCxZQUFZLENBQUNLLE1BSEU7QUFJdkJDLFlBQVEsRUFBRU4sWUFBWSxDQUFDTyxLQUFiLENBQW1CQyxJQUFuQixDQUF3QixDQUF4QixFQUEyQkMsS0FBM0IsQ0FBaUNOO0FBSnBCLEdBQXpCO0FBTUZPLFNBQU8sQ0FBQ0MsR0FBUixDQUFZZixZQUFaOztBQUNFLE1BQUlBLFlBQUosRUFBa0I7QUFDaEIsVUFBTUUsd0RBQUEsQ0FDSkMsaURBQUEsQ0FDRUEscURBQUEsQ0FBYSxlQUFiLENBREYsRUFFRTtBQUFFUyxVQUFJLEVBQUVOO0FBQVIsS0FGRixDQURJLENBQU47QUFNRCxHQVBELE1BT087QUFDTCxVQUFNSix3REFBQSxDQUNKQyxrREFBQSxDQUNFQSxpREFBQSxDQUNFLEtBREYsRUFFRUEsOENBQUEsQ0FDRUEsZ0RBQUEsQ0FDRUEsZ0RBQUEsQ0FBUSxvQkFBUixDQURGLEVBRUVMLGNBRkYsQ0FERixDQUZGLENBREYsRUFVRTtBQUFFYyxVQUFJLEVBQUVOO0FBQVIsS0FWRixDQURJLENBQU47QUFjRDtBQUNGIiwiZmlsZSI6Ii4vc3JjL3BhZ2VzL2FwaS9fbGliL21hbmFnZVN1YnNjcmlwdGlvbi50cy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHF1ZXJ5IGFzIHEgfSBmcm9tICdmYXVuYWRiJ1xuXG5pbXBvcnQgeyBmYXVuYSB9IGZyb20gXCIuLi8uLi8uLi9zZXJ2aWNlcy9mYXVuYVwiO1xuaW1wb3J0IHsgc3RyaXBlIH0gZnJvbSAnLi4vLi4vLi4vc2VydmljZXMvc3RyaXBlJztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNhdmVTdWJzY3JpcHRpb24oXG4gIHN1YnNjcmlwdGlvbklkOiBzdHJpbmcsXG4gIGN1c3RvbWVySWQ6IHN0cmluZyxcbiAgY3JlYXRlQWN0aW9uID0gZmFsc2Vcbikge1xuICBjb25zdCB1c2VyUmVmID0gYXdhaXQgZmF1bmEucXVlcnkoXG4gICAgcS5TZWxlY3QoXG4gICAgICBcInJlZlwiLFxuICAgICAgcS5HZXQoXG4gICAgICAgIHEuTWF0Y2goXG4gICAgICAgICAgcS5JbmRleCgndXNlcl9ieV9zdHJpcGVfY3VzdG9tZXJfaWQnKSxcbiAgICAgICAgICBjdXN0b21lcklkXG4gICAgICAgIClcbiAgICAgIClcbiAgICApXG4gICk7XG5cbiAgY29uc3Qgc3Vic2NyaXB0aW9uID0gYXdhaXQgc3RyaXBlLnN1YnNjcmlwdGlvbnMucmV0cmlldmUoc3Vic2NyaXB0aW9uSWQpXG5cbiAgY29uc3Qgc3Vic2NyaXB0aW9uRGF0YSA9IHtcbiAgICBpZDogc3Vic2NyaXB0aW9uLmlkLFxuICAgIHVzZXJJZDogdXNlclJlZixcbiAgICBzdGF0dXM6IHN1YnNjcmlwdGlvbi5zdGF0dXMsXG4gICAgcHJpY2VfaWQ6IHN1YnNjcmlwdGlvbi5pdGVtcy5kYXRhWzBdLnByaWNlLmlkLFxuICB9XG5jb25zb2xlLmxvZyhjcmVhdGVBY3Rpb24pO1xuICBpZiAoY3JlYXRlQWN0aW9uKSB7XG4gICAgYXdhaXQgZmF1bmEucXVlcnkoXG4gICAgICBxLkNyZWF0ZShcbiAgICAgICAgcS5Db2xsZWN0aW9uKCdzdWJzY3JpcHRpb25zJyksXG4gICAgICAgIHsgZGF0YTogc3Vic2NyaXB0aW9uRGF0YSB9XG4gICAgICApXG4gICAgKVxuICB9IGVsc2Uge1xuICAgIGF3YWl0IGZhdW5hLnF1ZXJ5KFxuICAgICAgcS5SZXBsYWNlKFxuICAgICAgICBxLlNlbGVjdChcbiAgICAgICAgICBcInJlZlwiLFxuICAgICAgICAgIHEuR2V0KFxuICAgICAgICAgICAgcS5NYXRjaChcbiAgICAgICAgICAgICAgcS5JbmRleCgnc3Vic2NyaXB0aW9uX2J5X2lkJyksXG4gICAgICAgICAgICAgIHN1YnNjcmlwdGlvbklkLFxuICAgICAgICAgICAgKVxuICAgICAgICAgIClcbiAgICAgICAgKSxcbiAgICAgICAgeyBkYXRhOiBzdWJzY3JpcHRpb25EYXRhIH1cbiAgICAgIClcbiAgICApXG4gIH1cbn0iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/pages/api/_lib/manageSubscription.ts\n");

/***/ }),

/***/ "./src/pages/api/webhooks.ts":
/*!***********************************!*\
  !*** ./src/pages/api/webhooks.ts ***!
  \***********************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"config\": function() { return /* binding */ config; }\n/* harmony export */ });\n/* harmony import */ var _services_stripe__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../services/stripe */ \"./src/services/stripe.ts\");\n/* harmony import */ var _lib_manageSubscription__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./_lib/manageSubscription */ \"./src/pages/api/_lib/manageSubscription.ts\");\n/* eslint-disable import/no-anonymous-default-export */\n\n\n\nasync function buffer(readable) {\n  const chunks = [];\n\n  for await (const chunk of readable) {\n    chunks.push(typeof chunk === 'string' ? Buffer.from(chunk) : chunk);\n  }\n\n  return Buffer.concat(chunks);\n}\n\nconst config = {\n  api: {\n    bodyParser: false\n  }\n};\nconst relevantEvents = new Set(['checkout.session.completed', 'customer.subscription.updated', 'customer.subscription.deleted']);\n/* harmony default export */ __webpack_exports__[\"default\"] = (async (req, res) => {\n  if (req.method === 'POST') {\n    const buf = await buffer(req);\n    const secret = req.headers['stripe-signature'];\n    let event;\n\n    try {\n      event = _services_stripe__WEBPACK_IMPORTED_MODULE_0__.stripe.webhooks.constructEvent(buf, secret, process.env.STRIPE_WEBHOOK_SECRET);\n    } catch (error) {\n      return res.status(400).send(`webhook error ${error.message}`);\n    }\n\n    const type = event.type;\n\n    if (relevantEvents.has(type)) {\n      try {\n        switch (type) {\n          case 'customer.subscription.updated':\n          case 'customer.subscription.deleted':\n            const subscription = event.data.object;\n            await (0,_lib_manageSubscription__WEBPACK_IMPORTED_MODULE_1__.saveSubscription)(subscription.id, subscription.customer.toString(), false);\n            break;\n\n          case 'checkout.session.completed':\n            const checkoutSession = event.data.object;\n            await (0,_lib_manageSubscription__WEBPACK_IMPORTED_MODULE_1__.saveSubscription)(checkoutSession.subscription.toString(), checkoutSession.customer.toString(), true);\n            break;\n\n          default:\n            throw new Error('Unhandled event.');\n        }\n      } catch (err) {\n        return res.json({\n          error: 'Webhook handler failed.'\n        });\n      }\n    }\n\n    res.json({\n      received: true\n    });\n  } else {\n    res.setHeader('Allow', 'POST');\n    res.status(405).end('Method not allowed');\n  }\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9pZ25ld3MvLi9zcmMvcGFnZXMvYXBpL3dlYmhvb2tzLnRzPzUyOWYiXSwibmFtZXMiOlsiYnVmZmVyIiwicmVhZGFibGUiLCJjaHVua3MiLCJjaHVuayIsInB1c2giLCJCdWZmZXIiLCJmcm9tIiwiY29uY2F0IiwiY29uZmlnIiwiYXBpIiwiYm9keVBhcnNlciIsInJlbGV2YW50RXZlbnRzIiwiU2V0IiwicmVxIiwicmVzIiwibWV0aG9kIiwiYnVmIiwic2VjcmV0IiwiaGVhZGVycyIsImV2ZW50Iiwic3RyaXBlIiwicHJvY2VzcyIsImVudiIsIlNUUklQRV9XRUJIT09LX1NFQ1JFVCIsImVycm9yIiwic3RhdHVzIiwic2VuZCIsIm1lc3NhZ2UiLCJ0eXBlIiwiaGFzIiwic3Vic2NyaXB0aW9uIiwiZGF0YSIsIm9iamVjdCIsInNhdmVTdWJzY3JpcHRpb24iLCJpZCIsImN1c3RvbWVyIiwidG9TdHJpbmciLCJjaGVja291dFNlc3Npb24iLCJFcnJvciIsImVyciIsImpzb24iLCJyZWNlaXZlZCIsInNldEhlYWRlciIsImVuZCJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFJQTtBQUNBOztBQUVBLGVBQWVBLE1BQWYsQ0FBc0JDLFFBQXRCLEVBQXdDO0FBQ3BDLFFBQU1DLE1BQU0sR0FBRyxFQUFmOztBQUVBLGFBQVcsTUFBTUMsS0FBakIsSUFBMEJGLFFBQTFCLEVBQW1DO0FBQy9CQyxVQUFNLENBQUNFLElBQVAsQ0FDSSxPQUFPRCxLQUFQLEtBQWlCLFFBQWpCLEdBQTRCRSxNQUFNLENBQUNDLElBQVAsQ0FBWUgsS0FBWixDQUE1QixHQUFpREEsS0FEckQ7QUFHSDs7QUFFRCxTQUFPRSxNQUFNLENBQUNFLE1BQVAsQ0FBY0wsTUFBZCxDQUFQO0FBQ0g7O0FBRU0sTUFBTU0sTUFBTSxHQUFHO0FBQ2xCQyxLQUFHLEVBQUU7QUFDREMsY0FBVSxFQUFFO0FBRFg7QUFEYSxDQUFmO0FBTVAsTUFBTUMsY0FBYyxHQUFHLElBQUlDLEdBQUosQ0FBUSxDQUMzQiw0QkFEMkIsRUFFM0IsK0JBRjJCLEVBRzNCLCtCQUgyQixDQUFSLENBQXZCO0FBTUEsK0RBQWUsT0FBT0MsR0FBUCxFQUE0QkMsR0FBNUIsS0FBbUQ7QUFDOUQsTUFBR0QsR0FBRyxDQUFDRSxNQUFKLEtBQWUsTUFBbEIsRUFBeUI7QUFDckIsVUFBTUMsR0FBRyxHQUFHLE1BQU1oQixNQUFNLENBQUNhLEdBQUQsQ0FBeEI7QUFDQSxVQUFNSSxNQUFNLEdBQUdKLEdBQUcsQ0FBQ0ssT0FBSixDQUFZLGtCQUFaLENBQWY7QUFFQSxRQUFJQyxLQUFKOztBQUVBLFFBQUk7QUFDQUEsV0FBSyxHQUFHQyw0RUFBQSxDQUErQkosR0FBL0IsRUFBb0NDLE1BQXBDLEVBQTRDSSxPQUFPLENBQUNDLEdBQVIsQ0FBWUMscUJBQXhELENBQVI7QUFDSCxLQUZELENBRUUsT0FBT0MsS0FBUCxFQUFjO0FBQ1osYUFBT1YsR0FBRyxDQUFDVyxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBc0IsaUJBQWdCRixLQUFLLENBQUNHLE9BQVEsRUFBcEQsQ0FBUDtBQUNIOztBQUVELFVBQU1DLElBQUksR0FBR1QsS0FBSyxDQUFDUyxJQUFuQjs7QUFFQSxRQUFHakIsY0FBYyxDQUFDa0IsR0FBZixDQUFtQkQsSUFBbkIsQ0FBSCxFQUE0QjtBQUN4QixVQUFJO0FBQ0EsZ0JBQU9BLElBQVA7QUFDSSxlQUFLLCtCQUFMO0FBQ0EsZUFBSywrQkFBTDtBQUNJLGtCQUFNRSxZQUFZLEdBQUdYLEtBQUssQ0FBQ1ksSUFBTixDQUFXQyxNQUFoQztBQUVBLGtCQUFNQyx5RUFBZ0IsQ0FDbEJILFlBQVksQ0FBQ0ksRUFESyxFQUVsQkosWUFBWSxDQUFDSyxRQUFiLENBQXNCQyxRQUF0QixFQUZrQixFQUdsQixLQUhrQixDQUF0QjtBQU1BOztBQUNKLGVBQUssNEJBQUw7QUFDSSxrQkFBTUMsZUFBZSxHQUFHbEIsS0FBSyxDQUFDWSxJQUFOLENBQVdDLE1BQW5DO0FBQ0Esa0JBQU1DLHlFQUFnQixDQUNsQkksZUFBZSxDQUFDUCxZQUFoQixDQUE2Qk0sUUFBN0IsRUFEa0IsRUFFbEJDLGVBQWUsQ0FBQ0YsUUFBaEIsQ0FBeUJDLFFBQXpCLEVBRmtCLEVBR2xCLElBSGtCLENBQXRCO0FBTUE7O0FBQ0o7QUFDSSxrQkFBTSxJQUFJRSxLQUFKLENBQVUsa0JBQVYsQ0FBTjtBQXRCUjtBQXdCSCxPQXpCRCxDQXlCRSxPQUFPQyxHQUFQLEVBQVk7QUFDVixlQUFPekIsR0FBRyxDQUFDMEIsSUFBSixDQUFTO0FBQUVoQixlQUFLLEVBQUU7QUFBVCxTQUFULENBQVA7QUFDSDtBQUNKOztBQUVEVixPQUFHLENBQUMwQixJQUFKLENBQVM7QUFBRUMsY0FBUSxFQUFFO0FBQVosS0FBVDtBQUNILEdBOUNELE1BOENLO0FBQ0QzQixPQUFHLENBQUM0QixTQUFKLENBQWMsT0FBZCxFQUF1QixNQUF2QjtBQUNBNUIsT0FBRyxDQUFDVyxNQUFKLENBQVcsR0FBWCxFQUFnQmtCLEdBQWhCLENBQW9CLG9CQUFwQjtBQUNIO0FBQ0osQ0FuREQiLCJmaWxlIjoiLi9zcmMvcGFnZXMvYXBpL3dlYmhvb2tzLnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgaW1wb3J0L25vLWFub255bW91cy1kZWZhdWx0LWV4cG9ydCAqL1xuaW1wb3J0IHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gXCJuZXh0XCI7XG5pbXBvcnQgeyBSZWFkYWJsZSB9IGZyb20gJ3N0cmVhbSc7XG5pbXBvcnQgU3RyaXBlIGZyb20gXCJzdHJpcGVcIjtcbmltcG9ydCB7IHN0cmlwZSB9IGZyb20gXCIuLi8uLi9zZXJ2aWNlcy9zdHJpcGVcIjtcbmltcG9ydCB7IHNhdmVTdWJzY3JpcHRpb24gfSBmcm9tIFwiLi9fbGliL21hbmFnZVN1YnNjcmlwdGlvblwiO1xuXG5hc3luYyBmdW5jdGlvbiBidWZmZXIocmVhZGFibGU6UmVhZGFibGUpe1xuICAgIGNvbnN0IGNodW5rcyA9IFtdO1xuXG4gICAgZm9yIGF3YWl0IChjb25zdCBjaHVuayBvZiByZWFkYWJsZSl7XG4gICAgICAgIGNodW5rcy5wdXNoKFxuICAgICAgICAgICAgdHlwZW9mIGNodW5rID09PSAnc3RyaW5nJyA/IEJ1ZmZlci5mcm9tKGNodW5rKSA6IGNodW5rLFxuICAgICAgICApO1xuICAgIH1cblxuICAgIHJldHVybiBCdWZmZXIuY29uY2F0KGNodW5rcyk7XG59XG5cbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XG4gICAgYXBpOiB7XG4gICAgICAgIGJvZHlQYXJzZXI6IGZhbHNlLFxuICAgIH1cbn1cblxuY29uc3QgcmVsZXZhbnRFdmVudHMgPSBuZXcgU2V0KFtcbiAgICAnY2hlY2tvdXQuc2Vzc2lvbi5jb21wbGV0ZWQnLFxuICAgICdjdXN0b21lci5zdWJzY3JpcHRpb24udXBkYXRlZCcsXG4gICAgJ2N1c3RvbWVyLnN1YnNjcmlwdGlvbi5kZWxldGVkJyxcbl0pXG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIChyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSk9PntcbiAgICBpZihyZXEubWV0aG9kID09PSAnUE9TVCcpe1xuICAgICAgICBjb25zdCBidWYgPSBhd2FpdCBidWZmZXIocmVxKTtcbiAgICAgICAgY29uc3Qgc2VjcmV0ID0gcmVxLmhlYWRlcnNbJ3N0cmlwZS1zaWduYXR1cmUnXTtcbiAgICAgICAgXG4gICAgICAgIGxldCBldmVudDogU3RyaXBlLkV2ZW50O1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBldmVudCA9IHN0cmlwZS53ZWJob29rcy5jb25zdHJ1Y3RFdmVudChidWYsIHNlY3JldCwgcHJvY2Vzcy5lbnYuU1RSSVBFX1dFQkhPT0tfU0VDUkVUKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChgd2ViaG9vayBlcnJvciAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHR5cGUgPSBldmVudC50eXBlO1xuXG4gICAgICAgIGlmKHJlbGV2YW50RXZlbnRzLmhhcyh0eXBlKSl7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCh0eXBlKXtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnY3VzdG9tZXIuc3Vic2NyaXB0aW9uLnVwZGF0ZWQnOlxuICAgICAgICAgICAgICAgICAgICBjYXNlICdjdXN0b21lci5zdWJzY3JpcHRpb24uZGVsZXRlZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdWJzY3JpcHRpb24gPSBldmVudC5kYXRhLm9iamVjdCBhcyBTdHJpcGUuU3Vic2NyaXB0aW9uO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBzYXZlU3Vic2NyaXB0aW9uKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbi5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24uY3VzdG9tZXIudG9TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgKVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnY2hlY2tvdXQuc2Vzc2lvbi5jb21wbGV0ZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hlY2tvdXRTZXNzaW9uID0gZXZlbnQuZGF0YS5vYmplY3QgYXMgU3RyaXBlLkNoZWNrb3V0LlNlc3Npb247XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBzYXZlU3Vic2NyaXB0aW9uKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrb3V0U2Vzc2lvbi5zdWJzY3JpcHRpb24udG9TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGVja291dFNlc3Npb24uY3VzdG9tZXIudG9TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICApXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVbmhhbmRsZWQgZXZlbnQuJylcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oeyBlcnJvcjogJ1dlYmhvb2sgaGFuZGxlciBmYWlsZWQuJyB9KVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXG4gICAgICAgIHJlcy5qc29uKHsgcmVjZWl2ZWQ6IHRydWV9KTtcbiAgICB9ZWxzZXtcbiAgICAgICAgcmVzLnNldEhlYWRlcignQWxsb3cnLCAnUE9TVCcpO1xuICAgICAgICByZXMuc3RhdHVzKDQwNSkuZW5kKCdNZXRob2Qgbm90IGFsbG93ZWQnKTtcbiAgICB9XG59Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/pages/api/webhooks.ts\n");

/***/ }),

/***/ "./src/services/fauna.ts":
/*!*******************************!*\
  !*** ./src/services/fauna.ts ***!
  \*******************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"fauna\": function() { return /* binding */ fauna; }\n/* harmony export */ });\n/* harmony import */ var faunadb__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! faunadb */ \"faunadb\");\n/* harmony import */ var faunadb__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(faunadb__WEBPACK_IMPORTED_MODULE_0__);\n\nconst fauna = new faunadb__WEBPACK_IMPORTED_MODULE_0__.Client({\n  secret: process.env.FAUNADB_SECRET\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9pZ25ld3MvLi9zcmMvc2VydmljZXMvZmF1bmEudHM/OGY0ZCJdLCJuYW1lcyI6WyJmYXVuYSIsIkNsaWVudCIsInNlY3JldCIsInByb2Nlc3MiLCJlbnYiLCJGQVVOQURCX1NFQ1JFVCJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFFTyxNQUFNQSxLQUFLLEdBQUcsSUFBSUMsMkNBQUosQ0FBVztBQUM1QkMsUUFBTSxFQUFFQyxPQUFPLENBQUNDLEdBQVIsQ0FBWUM7QUFEUSxDQUFYLENBQWQiLCJmaWxlIjoiLi9zcmMvc2VydmljZXMvZmF1bmEudHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDbGllbnQgfSBmcm9tICdmYXVuYWRiJztcblxuZXhwb3J0IGNvbnN0IGZhdW5hID0gbmV3IENsaWVudCh7XG4gICAgc2VjcmV0OiBwcm9jZXNzLmVudi5GQVVOQURCX1NFQ1JFVFxufSk7Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/services/fauna.ts\n");

/***/ }),

/***/ "./src/services/stripe.ts":
/*!********************************!*\
  !*** ./src/services/stripe.ts ***!
  \********************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"stripe\": function() { return /* binding */ stripe; }\n/* harmony export */ });\n/* harmony import */ var _package_json__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../package.json */ \"./package.json\");\n/* harmony import */ var stripe__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! stripe */ \"stripe\");\n/* harmony import */ var stripe__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(stripe__WEBPACK_IMPORTED_MODULE_1__);\n\n\nconst stripe = new (stripe__WEBPACK_IMPORTED_MODULE_1___default())(process.env.STRIPE_KEY, {\n  apiVersion: '2020-08-27',\n  appInfo: {\n    name: 'Ignews',\n    version: _package_json__WEBPACK_IMPORTED_MODULE_0__.version\n  }\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9pZ25ld3MvLi9zcmMvc2VydmljZXMvc3RyaXBlLnRzP2Q5NjgiXSwibmFtZXMiOlsic3RyaXBlIiwiU3RyaXBlIiwicHJvY2VzcyIsImVudiIsIlNUUklQRV9LRVkiLCJhcGlWZXJzaW9uIiwiYXBwSW5mbyIsIm5hbWUiLCJ2ZXJzaW9uIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7QUFFQTtBQUVPLE1BQU1BLE1BQU0sR0FBRyxJQUFJQywrQ0FBSixDQUNsQkMsT0FBTyxDQUFDQyxHQUFSLENBQVlDLFVBRE0sRUFFbEI7QUFDSUMsWUFBVSxFQUFFLFlBRGhCO0FBRUlDLFNBQU8sRUFBRTtBQUNMQyxRQUFJLEVBQUUsUUFERDtBQUVMQyxXQUFPQTtBQUZGO0FBRmIsQ0FGa0IsQ0FBZiIsImZpbGUiOiIuL3NyYy9zZXJ2aWNlcy9zdHJpcGUudHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB2ZXJzaW9uIH0gZnJvbSAnLi4vLi4vcGFja2FnZS5qc29uJztcblxuaW1wb3J0IFN0cmlwZSBmcm9tICdzdHJpcGUnO1xuXG5leHBvcnQgY29uc3Qgc3RyaXBlID0gbmV3IFN0cmlwZShcbiAgICBwcm9jZXNzLmVudi5TVFJJUEVfS0VZLFxuICAgIHtcbiAgICAgICAgYXBpVmVyc2lvbjogJzIwMjAtMDgtMjcnLFxuICAgICAgICBhcHBJbmZvOiB7XG4gICAgICAgICAgICBuYW1lOiAnSWduZXdzJyxcbiAgICAgICAgICAgIHZlcnNpb25cbiAgICAgICAgfVxuICAgIH1cbik7Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/services/stripe.ts\n");

/***/ }),

/***/ "./package.json":
/*!**********************!*\
  !*** ./package.json ***!
  \**********************/
/***/ (function(module) {

"use strict";
module.exports = JSON.parse('{"name":"ignews","version":"0.1.0","private":true,"scripts":{"dev":"next dev","build":"next build","start":"next start","lint":"next lint"},"dependencies":{"@stripe/stripe-js":"^1.16.0","axios":"^0.21.1","faunadb":"^4.3.0","next":"11.0.1","next-auth":"^3.27.3","react":"17.0.2","react-dom":"17.0.2","react-icons":"^4.2.0","sass":"^1.35.2","stripe":"^8.165.0"},"devDependencies":{"@types/node":"^16.4.0","@types/react":"^17.0.14","eslint":"7.31.0","eslint-config-next":"11.0.1","typescript":"^4.3.5"}}');

/***/ }),

/***/ "faunadb":
/*!**************************!*\
  !*** external "faunadb" ***!
  \**************************/
/***/ (function(module) {

"use strict";
module.exports = require("faunadb");;

/***/ }),

/***/ "stripe":
/*!*************************!*\
  !*** external "stripe" ***!
  \*************************/
/***/ (function(module) {

"use strict";
module.exports = require("stripe");;

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = function(moduleId) { return __webpack_require__(__webpack_require__.s = moduleId); }
var __webpack_exports__ = (__webpack_exec__("./src/pages/api/webhooks.ts"));
module.exports = __webpack_exports__;

})();